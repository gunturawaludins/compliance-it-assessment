import { FraudRule } from '@/types/assessment';

// Comprehensive fraud detection rules based on COBIT 2019 Framework
export const defaultFraudRules: FraudRule[] = [
  // =====================================================
  // DOMAIN EDM - Evaluate, Direct and Monitor
  // =====================================================
  { 
    id: 'COBIT_EDM01_001', 
    name: 'Governance Framework Tanpa Evaluasi Berkala', 
    description: 'Klaim memiliki framework governance (A.1=Ya) tetapi tidak ada evaluasi berkala. [COBIT EDM01 - Ensured Governance Framework Setting]', 
    conditionQuestionId: 'A.1', 
    conditionAnswer: 'Ya', 
    evidenceQuestionId: 'A.1.b', 
    evidenceCondition: 'Tidak', 
    severity: 'major', 
    fraudType: 'Inkonsistensi Kebijakan',
    cobitRef: 'EDM01',
  },
  { 
    id: 'COBIT_EDM01_002', 
    name: 'Komite TI Tanpa Struktur Lengkap', 
    description: 'Klaim Komite TI ada (A.5=Ya) tetapi anggota tidak lengkap. [COBIT EDM01.02 - Direct the Governance System]', 
    conditionQuestionId: 'A.5', 
    conditionAnswer: 'Ya', 
    evidenceQuestionId: 'A.6', 
    evidenceCondition: 'Tidak', 
    severity: 'major', 
    fraudType: 'Manipulasi Administratif',
    cobitRef: 'EDM01',
  },
  { 
    id: 'COBIT_EDM02_001', 
    name: 'Benefit Delivery Tanpa Pengukuran', 
    description: 'Klaim investasi TI memberikan manfaat tetapi tidak ada pengukuran. [COBIT EDM02 - Ensured Benefits Delivery]', 
    conditionQuestionId: 'A.2', 
    conditionAnswer: 'Ya', 
    evidenceQuestionId: 'A.2.h', 
    evidenceCondition: 'Tidak', 
    severity: 'major', 
    fraudType: 'Operasional Fiktif',
    cobitRef: 'EDM02',
  },
  { 
    id: 'COBIT_EDM03_001', 
    name: 'Risk Optimization Tanpa Toleransi Risiko', 
    description: 'Klaim optimasi risiko tetapi tidak ada penetapan toleransi risiko. [COBIT EDM03 - Ensured Risk Optimization]', 
    conditionQuestionId: 'C.1', 
    conditionAnswer: 'Ya', 
    evidenceQuestionId: 'C.2', 
    evidenceCondition: 'Tidak', 
    severity: 'major', 
    fraudType: 'Inkonsistensi Kebijakan',
    cobitRef: 'EDM03',
  },
  { 
    id: 'COBIT_EDM04_001', 
    name: 'Resource Optimization Tanpa Perencanaan SDM', 
    description: 'Klaim optimasi sumber daya tetapi tidak ada perencanaan SDM TI. [COBIT EDM04 - Ensured Resource Optimization]', 
    conditionQuestionId: 'A.2.d', 
    conditionAnswer: 'Ya', 
    evidenceQuestionId: 'A.2.d.c', 
    evidenceCondition: 'Tidak', 
    severity: 'minor', 
    fraudType: 'Bukti Tidak Memadai',
    cobitRef: 'EDM04',
  },
  { 
    id: 'COBIT_EDM05_001', 
    name: 'Stakeholder Engagement Tanpa Dokumentasi Rapat', 
    description: 'Klaim engagement stakeholder (A.8=Ya) tetapi tidak ada dokumentasi rapat. [COBIT EDM05 - Ensured Stakeholder Engagement]', 
    conditionQuestionId: 'A.8', 
    conditionAnswer: 'Ya', 
    evidenceQuestionId: 'A.9', 
    evidenceCondition: 'Tidak', 
    severity: 'major', 
    fraudType: 'Operasional Fiktif',
    cobitRef: 'EDM05',
  },

  // =====================================================
  // DOMAIN APO - Align, Plan and Organize
  // =====================================================
  { 
    id: 'COBIT_APO01_001', 
    name: 'IT Management Framework Tanpa Struktur', 
    description: 'Klaim memiliki framework manajemen TI tetapi struktur tidak jelas. [COBIT APO01 - Managed I&T Management Framework]', 
    conditionQuestionId: 'A.4', 
    conditionAnswer: 'Ya', 
    evidenceQuestionId: 'A.4.a', 
    evidenceCondition: 'Tidak', 
    severity: 'major', 
    fraudType: 'Inkonsistensi Kebijakan',
    cobitRef: 'APO01',
  },
  { 
    id: 'COBIT_APO02_001', 
    name: 'Strategy Tanpa Rencana TI', 
    description: 'Klaim strategi TI tetapi tidak ada rencana strategis. [COBIT APO02 - Managed Strategy]', 
    conditionQuestionId: 'A.4', 
    conditionAnswer: 'Ya', 
    evidenceQuestionId: 'A.4.b', 
    evidenceCondition: 'Tidak', 
    severity: 'major', 
    fraudType: 'Bukti Tidak Memadai',
    cobitRef: 'APO02',
  },
  { 
    id: 'COBIT_APO07_001', 
    name: 'HR Management Tanpa Kompetensi', 
    description: 'Klaim manajemen SDM TI tetapi tidak ada program kompetensi. [COBIT APO07 - Managed Human Resources]', 
    conditionQuestionId: 'A.2.d', 
    conditionAnswer: 'Ya', 
    evidenceQuestionId: 'A.2.d.c', 
    evidenceCondition: 'Tidak', 
    severity: 'minor', 
    fraudType: 'Operasional Fiktif',
    cobitRef: 'APO07',
  },
  { 
    id: 'COBIT_APO10_001', 
    name: 'Vendor Management Tanpa SLA', 
    description: 'Klaim manajemen vendor tetapi tidak ada SLA yang jelas. [COBIT APO10 - Managed Vendors]', 
    conditionQuestionId: 'B.23', 
    conditionAnswer: 'Ya', 
    evidenceQuestionId: 'B.23.b', 
    evidenceCondition: 'Tidak', 
    severity: 'major', 
    fraudType: 'Bukti Tidak Memadai',
    cobitRef: 'APO10',
  },
  { 
    id: 'COBIT_APO10_002', 
    name: 'Vendor TI Tanpa Review Kepatuhan', 
    description: 'Klaim menggunakan vendor (C.10=Ya) tetapi tidak ada review kepatuhan. [COBIT APO10.04 - Monitor Vendor Performance]', 
    conditionQuestionId: 'C.10', 
    conditionAnswer: 'Ya', 
    evidenceQuestionId: 'C.11', 
    evidenceCondition: 'Tidak', 
    severity: 'major', 
    fraudType: 'Inkonsistensi Kebijakan',
    cobitRef: 'APO10',
  },
  { 
    id: 'COBIT_APO11_001', 
    name: 'Quality Management Tanpa Standar', 
    description: 'Klaim manajemen kualitas tetapi tidak ada standar kualitas. [COBIT APO11 - Managed Quality]', 
    conditionQuestionId: 'B.6', 
    conditionAnswer: 'Ya', 
    evidenceQuestionId: 'B.14', 
    evidenceCondition: 'Tidak', 
    severity: 'major', 
    fraudType: 'Bukti Tidak Memadai',
    cobitRef: 'APO11',
  },
  { 
    id: 'COBIT_APO12_001', 
    name: 'Risk Management Tanpa Risk Register', 
    description: 'Klaim manajemen risiko tetapi tidak ada risk register. [COBIT APO12.02 - Analyze Risk]', 
    conditionQuestionId: 'C.1', 
    conditionAnswer: 'Ya', 
    evidenceQuestionId: 'C.4', 
    evidenceCondition: 'Tidak', 
    severity: 'major', 
    fraudType: 'Bukti Tidak Memadai',
    cobitRef: 'APO12',
  },
  { 
    id: 'COBIT_APO12_002', 
    name: 'Identifikasi Risiko Tidak Komprehensif', 
    description: 'Klaim identifikasi risiko tetapi tidak mencakup operasional. [COBIT APO12 - Managed Risk]', 
    conditionQuestionId: 'C.3', 
    conditionAnswer: 'Ya', 
    evidenceQuestionId: 'C.3.c', 
    evidenceCondition: 'Tidak', 
    severity: 'major', 
    fraudType: 'Inkonsistensi Kebijakan',
    cobitRef: 'APO12',
  },
  { 
    id: 'COBIT_APO13_001', 
    name: 'Security Management Tanpa Kebijakan', 
    description: 'Klaim keamanan informasi tetapi tidak ada kebijakan keamanan. [COBIT APO13 - Managed Security]', 
    conditionQuestionId: 'C.24', 
    conditionAnswer: 'Ya', 
    evidenceQuestionId: 'C.25.d', 
    evidenceCondition: 'Tidak', 
    severity: 'major', 
    fraudType: 'Inkonsistensi Kebijakan',
    cobitRef: 'APO13',
  },

  // =====================================================
  // DOMAIN BAI - Build, Acquire and Implement
  // =====================================================
  { 
    id: 'COBIT_BAI01_001', 
    name: 'Program Management Tanpa Inisiasi', 
    description: 'Klaim prosedur pengembangan tetapi tidak ada fase inisiasi. [COBIT BAI01 - Managed Programs]', 
    conditionQuestionId: 'B.6', 
    conditionAnswer: 'Ya', 
    evidenceQuestionId: 'B.6.1', 
    evidenceCondition: 'Tidak', 
    severity: 'major', 
    fraudType: 'Inkonsistensi Kebijakan',
    cobitRef: 'BAI01',
  },
  { 
    id: 'COBIT_BAI02_001', 
    name: 'Requirements Tanpa Definisi', 
    description: 'Klaim prosedur pengembangan tetapi tidak ada definisi kebutuhan. [COBIT BAI02 - Managed Requirements Definition]', 
    conditionQuestionId: 'B.6', 
    conditionAnswer: 'Ya', 
    evidenceQuestionId: 'B.6.2', 
    evidenceCondition: 'Tidak', 
    severity: 'major', 
    fraudType: 'Inkonsistensi Kebijakan',
    cobitRef: 'BAI02',
  },
  { 
    id: 'COBIT_BAI03_001', 
    name: 'Solutions Tanpa UAT', 
    description: 'Klaim pengujian sistem tetapi tidak ada UAT terdokumentasi. [COBIT BAI03.07 - Prepare for Solution Testing]', 
    conditionQuestionId: 'B.6.5', 
    conditionAnswer: 'Ya', 
    evidenceQuestionId: 'B.14', 
    evidenceCondition: 'Tidak', 
    severity: 'major', 
    fraudType: 'Bukti Tidak Memadai',
    cobitRef: 'BAI03',
  },
  { 
    id: 'COBIT_BAI06_001', 
    name: 'IT Changes Tanpa Change Management', 
    description: 'Klaim kebijakan operasional tetapi tidak ada change management. [COBIT BAI06 - Managed IT Changes]', 
    conditionQuestionId: 'B.29', 
    conditionAnswer: 'Ya', 
    evidenceQuestionId: 'B.29.b', 
    evidenceCondition: 'Tidak', 
    severity: 'major', 
    fraudType: 'Inkonsistensi Kebijakan',
    cobitRef: 'BAI06',
  },
  { 
    id: 'COBIT_BAI09_001', 
    name: 'Asset Management Tanpa Inventaris', 
    description: 'Klaim manajemen aset tetapi tidak ada inventaris aset TI. [COBIT BAI09 - Managed Assets]', 
    conditionQuestionId: 'B.30', 
    conditionAnswer: 'Ya', 
    evidenceQuestionId: 'B.30.1', 
    evidenceCondition: 'Tidak', 
    severity: 'major', 
    fraudType: 'Bukti Tidak Memadai',
    cobitRef: 'BAI09',
  },
  { 
    id: 'COBIT_BAI10_001', 
    name: 'Configuration Tanpa Dokumentasi', 
    description: 'Klaim manajemen konfigurasi tetapi tidak ada dokumentasi. [COBIT BAI10 - Managed Configuration]', 
    conditionQuestionId: 'B.30', 
    conditionAnswer: 'Ya', 
    evidenceQuestionId: 'B.30.2', 
    evidenceCondition: 'Tidak', 
    severity: 'major', 
    fraudType: 'Inkonsistensi Kebijakan',
    cobitRef: 'BAI10',
  },

  // =====================================================
  // DOMAIN DSS - Deliver, Service and Support
  // =====================================================
  { 
    id: 'COBIT_DSS01_001', 
    name: 'Operations Tanpa Monitoring', 
    description: 'Klaim kebijakan operasional tetapi tidak ada monitoring kinerja. [COBIT DSS01 - Managed Operations]', 
    conditionQuestionId: 'B.40', 
    conditionAnswer: 'Ya', 
    evidenceQuestionId: 'B.40.a', 
    evidenceCondition: 'Tidak', 
    severity: 'major', 
    fraudType: 'Operasional Fiktif',
    cobitRef: 'DSS01',
  },
  { 
    id: 'COBIT_DSS01_002', 
    name: 'Network Tanpa Manajemen', 
    description: 'Klaim kebijakan jaringan tetapi tidak ada manajemen jaringan. [COBIT DSS01.04 - Manage the Environment]', 
    conditionQuestionId: 'B.40', 
    conditionAnswer: 'Ya', 
    evidenceQuestionId: 'B.40.c', 
    evidenceCondition: 'Tidak', 
    severity: 'major', 
    fraudType: 'Inkonsistensi Kebijakan',
    cobitRef: 'DSS01',
  },
  { 
    id: 'COBIT_DSS02_001', 
    name: 'Service Request Tanpa Incident Management', 
    description: 'Klaim kebijakan operasional tetapi tidak ada incident management. [COBIT DSS02 - Managed Service Requests and Incidents]', 
    conditionQuestionId: 'B.29', 
    conditionAnswer: 'Ya', 
    evidenceQuestionId: 'B.29.c', 
    evidenceCondition: 'Tidak', 
    severity: 'major', 
    fraudType: 'Inkonsistensi Kebijakan',
    cobitRef: 'DSS02',
  },
  { 
    id: 'COBIT_DSS03_001', 
    name: 'Problems Tanpa Root Cause Analysis', 
    description: 'Klaim kebijakan jaringan tetapi tidak ada analisis masalah. [COBIT DSS03 - Managed Problems]', 
    conditionQuestionId: 'B.40', 
    conditionAnswer: 'Ya', 
    evidenceQuestionId: 'B.40.d', 
    evidenceCondition: 'Tidak', 
    severity: 'major', 
    fraudType: 'Inkonsistensi Kebijakan',
    cobitRef: 'DSS03',
  },
  { 
    id: 'COBIT_DSS04_001', 
    name: 'Continuity Tanpa DRP Testing', 
    description: 'Klaim DRP tetapi tidak pernah diuji. [COBIT DSS04.05 - Review, Maintain and Improve the Continuity Plan]', 
    conditionQuestionId: 'B.52', 
    conditionAnswer: 'Ya', 
    evidenceQuestionId: 'B.52.e', 
    evidenceCondition: 'Tidak', 
    severity: 'major', 
    fraudType: 'Operasional Fiktif',
    cobitRef: 'DSS04',
  },
  { 
    id: 'COBIT_DSS04_002', 
    name: 'Continuity Tanpa Update DRP', 
    description: 'Klaim DRP tetapi tidak ada pengkinian berkala. [COBIT DSS04.04 - Exercise, Test and Review the BCP]', 
    conditionQuestionId: 'B.52', 
    conditionAnswer: 'Ya', 
    evidenceQuestionId: 'B.52.f', 
    evidenceCondition: 'Tidak', 
    severity: 'minor', 
    fraudType: 'Bukti Tidak Memadai',
    cobitRef: 'DSS04',
  },
  { 
    id: 'COBIT_DSS04_003', 
    name: 'Backup Tanpa Testing', 
    description: 'Klaim backup rutin tetapi tidak pernah diuji restore. [COBIT DSS04.03 - Develop and Implement a BCM Response]', 
    conditionQuestionId: 'B.35', 
    conditionAnswer: 'Ya', 
    evidenceQuestionId: 'B.35.c', 
    evidenceCondition: 'Tidak', 
    severity: 'major', 
    fraudType: 'Operasional Fiktif',
    cobitRef: 'DSS04',
  },
  { 
    id: 'COBIT_DSS04_004', 
    name: 'DRP Efektif Tanpa Daftar Kritikal', 
    description: 'Klaim DRP efektif tetapi tidak ada daftar aplikasi kritikal. [COBIT DSS04 - Managed Continuity]', 
    conditionQuestionId: 'C.19', 
    conditionAnswer: 'Ya', 
    evidenceQuestionId: 'C.20', 
    evidenceCondition: 'Tidak', 
    severity: 'major', 
    fraudType: 'Bukti Tidak Memadai',
    cobitRef: 'DSS04',
  },
  { 
    id: 'COBIT_DSS05_001', 
    name: 'Security Services Tanpa Access Review', 
    description: 'Klaim access control tetapi tidak ada user access review. [COBIT DSS05 - Managed Security Services]', 
    conditionQuestionId: 'B.46', 
    conditionAnswer: 'Ya', 
    evidenceQuestionId: 'B.46.c', 
    evidenceCondition: 'Tidak', 
    severity: 'minor', 
    fraudType: 'Inkonsistensi Kebijakan',
    cobitRef: 'DSS05',
  },
  { 
    id: 'COBIT_DSS05_002', 
    name: 'Network Security Tanpa Pengamanan', 
    description: 'Klaim kebijakan jaringan tetapi tidak ada pengamanan. [COBIT DSS05.02 - Manage Network and Connectivity Security]', 
    conditionQuestionId: 'B.40', 
    conditionAnswer: 'Ya', 
    evidenceQuestionId: 'B.40.b', 
    evidenceCondition: 'Tidak', 
    severity: 'major', 
    fraudType: 'Inkonsistensi Kebijakan',
    cobitRef: 'DSS05',
  },
  { 
    id: 'COBIT_DSS06_001', 
    name: 'Business Process Controls Tanpa Validasi', 
    description: 'Klaim kebijakan lengkap tetapi tidak ada aspek operasional. [COBIT DSS06 - Managed Business Process Controls]', 
    conditionQuestionId: 'B.4', 
    conditionAnswer: 'Ya', 
    evidenceQuestionId: 'B.4.c', 
    evidenceCondition: 'Tidak', 
    severity: 'major', 
    fraudType: 'Inkonsistensi Kebijakan',
    cobitRef: 'DSS06',
  },

  // =====================================================
  // DOMAIN MEA - Monitor, Evaluate and Assess
  // =====================================================
  { 
    id: 'COBIT_MEA01_001', 
    name: 'Performance Monitoring Tanpa Kontinuitas', 
    description: 'Klaim pemantauan tetapi tidak kontinu. [COBIT MEA01.01 - Establish a Monitoring Approach]', 
    conditionQuestionId: 'D.4', 
    conditionAnswer: 'Ya', 
    evidenceQuestionId: 'D.4.a', 
    evidenceCondition: 'Tidak', 
    severity: 'major', 
    fraudType: 'Inkonsistensi Kebijakan',
    cobitRef: 'MEA01',
  },
  { 
    id: 'COBIT_MEA01_002', 
    name: 'Kebijakan TI Tanpa Review', 
    description: 'Klaim kebijakan TI tetapi tidak pernah review. [COBIT MEA01 - Managed Performance and Conformance Monitoring]', 
    conditionQuestionId: 'B.1', 
    conditionAnswer: 'Ya', 
    evidenceQuestionId: 'B.2', 
    evidenceCondition: 'Tidak', 
    severity: 'major', 
    fraudType: 'Inkonsistensi Kebijakan',
    cobitRef: 'MEA01',
  },
  { 
    id: 'COBIT_MEA02_001', 
    name: 'Internal Control Tanpa Pengawasan', 
    description: 'Klaim pengendalian internal tetapi tidak ada pengawasan. [COBIT MEA02 - Managed System of Internal Control]', 
    conditionQuestionId: 'D.1', 
    conditionAnswer: 'Ya', 
    evidenceQuestionId: 'D.2.a', 
    evidenceCondition: 'Tidak', 
    severity: 'major', 
    fraudType: 'Inkonsistensi Kebijakan',
    cobitRef: 'MEA02',
  },
  { 
    id: 'COBIT_MEA02_002', 
    name: 'Internal Control Tanpa Risk Identification', 
    description: 'Klaim pengendalian internal tetapi tidak ada identifikasi risiko. [COBIT MEA02 - Managed System of Internal Control]', 
    conditionQuestionId: 'D.1', 
    conditionAnswer: 'Ya', 
    evidenceQuestionId: 'D.2.b', 
    evidenceCondition: 'Tidak', 
    severity: 'major', 
    fraudType: 'Inkonsistensi Kebijakan',
    cobitRef: 'MEA02',
  },
  { 
    id: 'COBIT_MEA02_003', 
    name: 'Internal Control Tanpa Segregation of Duties', 
    description: 'Klaim pengendalian internal tetapi tidak ada pemisahan fungsi. [COBIT MEA02 - Managed System of Internal Control]', 
    conditionQuestionId: 'D.1', 
    conditionAnswer: 'Ya', 
    evidenceQuestionId: 'D.2.c', 
    evidenceCondition: 'Tidak', 
    severity: 'major', 
    fraudType: 'Inkonsistensi Kebijakan',
    cobitRef: 'MEA02',
  },
  { 
    id: 'COBIT_MEA03_001', 
    name: 'Compliance Tanpa Pemahaman Regulasi', 
    description: 'Klaim aspek manajemen lengkap tetapi tidak paham regulasi. [COBIT MEA03 - Managed Compliance with External Requirements]', 
    conditionQuestionId: 'B.5', 
    conditionAnswer: 'Ya', 
    evidenceQuestionId: 'B.5.c', 
    evidenceCondition: 'Tidak', 
    severity: 'major', 
    fraudType: 'Inkonsistensi Kebijakan',
    cobitRef: 'MEA03',
  },
  { 
    id: 'COBIT_MEA04_001', 
    name: 'Assurance Tanpa Audit Trail', 
    description: 'Klaim audit berkala tetapi tidak ada jejak audit. [COBIT MEA04 - Managed Assurance]', 
    conditionQuestionId: 'D.7', 
    conditionAnswer: 'Ya', 
    evidenceQuestionId: 'D.6', 
    evidenceCondition: 'Tidak', 
    severity: 'major', 
    fraudType: 'Operasional Fiktif',
    cobitRef: 'MEA04',
  },
  { 
    id: 'COBIT_MEA04_002', 
    name: 'Audit Tanpa Pedoman', 
    description: 'Klaim audit berkala tetapi tidak ada pedoman audit. [COBIT MEA04 - Managed Assurance]', 
    conditionQuestionId: 'D.7', 
    conditionAnswer: 'Ya', 
    evidenceQuestionId: 'D.9', 
    evidenceCondition: 'Tidak', 
    severity: 'major', 
    fraudType: 'Manipulasi Administratif',
    cobitRef: 'MEA04',
  },
];

export function generateRuleId(): string {
  return `COBIT_${Date.now().toString(36).toUpperCase()}`;
}

export function createFraudRule(
  name: string, 
  description: string, 
  conditionQuestionId: string, 
  conditionAnswer: 'Ya' | 'Tidak', 
  evidenceQuestionId: string, 
  evidenceCondition: 'empty' | 'Tidak', 
  severity: 'major' | 'minor', 
  fraudType: string,
  cobitRef: string
): FraudRule {
  return { 
    id: generateRuleId(), 
    name, 
    description, 
    conditionQuestionId, 
    conditionAnswer, 
    evidenceQuestionId, 
    evidenceCondition, 
    severity, 
    fraudType: fraudType as FraudRule['fraudType'],
    cobitRef,
  };
}
