import { FraudRule } from '@/types/assessment';

// Fraud detection rules - Logic Map
// Struktur fleksibel untuk menambah aturan logika deteksi kecurangan
export const defaultFraudRules: FraudRule[] = [
  // ============= KATEGORI A: TATA KELOLA =============
  {
    id: 'RULE001',
    name: 'Kebijakan Tanpa Job Description',
    description: 'Klaim memiliki wewenang dan tanggung jawab TI, tetapi tidak ada bukti Job Description',
    conditionQuestionId: 'A.1',
    conditionAnswer: 'Ya',
    evidenceQuestionId: 'DPA1',
    evidenceCondition: 'empty',
    severity: 'major',
    fraudType: 'Manipulasi Administratif',
  },
  {
    id: 'RULE002',
    name: 'Komite TI Tanpa SK',
    description: 'Klaim memiliki Komite TI, tetapi tidak ada SK Pembentukan',
    conditionQuestionId: 'A.5',
    conditionAnswer: 'Ya',
    evidenceQuestionId: 'DPA2',
    evidenceCondition: 'empty',
    severity: 'major',
    fraudType: 'Manipulasi Administratif',
  },
  {
    id: 'RULE003',
    name: 'Pertemuan Berkala Tanpa Dokumentasi',
    description: 'Klaim melakukan pertemuan berkala, tetapi tidak ada risalah rapat',
    conditionQuestionId: 'A.8',
    conditionAnswer: 'Ya',
    evidenceQuestionId: 'DPA3',
    evidenceCondition: 'empty',
    severity: 'major',
    fraudType: 'Operasional Fiktif',
  },

  // ============= KATEGORI B: KEBIJAKAN =============
  {
    id: 'RULE004',
    name: 'Kebijakan TI Tanpa Dokumen',
    description: 'Klaim memiliki kebijakan TI, tetapi dokumen tidak tersedia',
    conditionQuestionId: 'B.1',
    conditionAnswer: 'Ya',
    evidenceQuestionId: 'DPB1',
    evidenceCondition: 'empty',
    severity: 'major',
    fraudType: 'Manipulasi Administratif',
  },
  {
    id: 'RULE005',
    name: 'Backup Tanpa Uji Restore',
    description: 'Klaim melakukan backup berkala, tetapi tidak ada log uji restore',
    conditionQuestionId: 'B.35',
    conditionAnswer: 'Ya',
    evidenceQuestionId: 'DPA12',
    evidenceCondition: 'empty',
    severity: 'major',
    fraudType: 'Operasional Fiktif',
  },
  {
    id: 'RULE006',
    name: 'DRP Tanpa Dokumen',
    description: 'Klaim memiliki Rencana Pemulihan Bencana, tetapi dokumen DRP tidak tersedia',
    conditionQuestionId: 'B.52',
    conditionAnswer: 'Ya',
    evidenceQuestionId: 'DPB3',
    evidenceCondition: 'empty',
    severity: 'major',
    fraudType: 'Manipulasi Administratif',
  },
  {
    id: 'RULE007',
    name: 'Kaji Ulang Tanpa Bukti',
    description: 'Klaim melakukan kaji ulang berkala, tetapi tidak konsisten dengan pelaksanaan',
    conditionQuestionId: 'B.2',
    conditionAnswer: 'Ya',
    evidenceQuestionId: 'B.3',
    evidenceCondition: 'Tidak',
    severity: 'minor',
    fraudType: 'Inkonsistensi Kebijakan',
  },

  // ============= KATEGORI C: RISIKO =============
  {
    id: 'RULE008',
    name: 'Manajemen Risiko Tanpa Assessment',
    description: 'Klaim memiliki manajemen risiko TI, tetapi tidak ada dokumen risk assessment',
    conditionQuestionId: 'C.1',
    conditionAnswer: 'Ya',
    evidenceQuestionId: 'DPC1',
    evidenceCondition: 'empty',
    severity: 'major',
    fraudType: 'Inkonsistensi Kebijakan',
  },
  {
    id: 'RULE009',
    name: 'Inkonsistensi Implementasi Risiko',
    description: 'Klaim memiliki kebijakan risiko tetapi tidak konsisten dalam pelaksanaan',
    conditionQuestionId: 'C.1',
    conditionAnswer: 'Ya',
    evidenceQuestionId: 'C.2',
    evidenceCondition: 'Tidak',
    severity: 'minor',
    fraudType: 'Inkonsistensi Kebijakan',
  },
  {
    id: 'RULE010',
    name: 'DRP Tanpa Uji Coba',
    description: 'Klaim DRP dapat berjalan efektif, tetapi tidak ada laporan uji coba',
    conditionQuestionId: 'C.19',
    conditionAnswer: 'Ya',
    evidenceQuestionId: 'DPC2',
    evidenceCondition: 'empty',
    severity: 'major',
    fraudType: 'Operasional Fiktif',
  },
  {
    id: 'RULE011',
    name: 'DRP Efektif Tanpa Uji Coba',
    description: 'Klaim DRP efektif, tetapi belum pernah dilakukan uji coba',
    conditionQuestionId: 'C.19',
    conditionAnswer: 'Ya',
    evidenceQuestionId: 'C.21',
    evidenceCondition: 'Tidak',
    severity: 'major',
    fraudType: 'Operasional Fiktif',
  },
  {
    id: 'RULE012',
    name: 'Aplikasi Kritikal Tanpa Daftar',
    description: 'Klaim melakukan uji DRP untuk aplikasi kritikal, tetapi tidak ada daftar aplikasi',
    conditionQuestionId: 'C.21',
    conditionAnswer: 'Ya',
    evidenceQuestionId: 'DPC3',
    evidenceCondition: 'empty',
    severity: 'minor',
    fraudType: 'Bukti Tidak Memadai',
  },

  // ============= KATEGORI D: AUDIT =============
  {
    id: 'RULE013',
    name: 'Audit Internal Tanpa Laporan',
    description: 'Klaim melakukan audit internal TI, tetapi tidak ada laporan audit',
    conditionQuestionId: 'D.7',
    conditionAnswer: 'Ya',
    evidenceQuestionId: 'DPD1',
    evidenceCondition: 'empty',
    severity: 'major',
    fraudType: 'Operasional Fiktif',
  },
  {
    id: 'RULE014',
    name: 'Jejak Audit Tidak Tersedia',
    description: 'Klaim memiliki jejak audit, tetapi log tidak tersedia',
    conditionQuestionId: 'D.6',
    conditionAnswer: 'Ya',
    evidenceQuestionId: 'DPD2',
    evidenceCondition: 'empty',
    severity: 'minor',
    fraudType: 'Bukti Tidak Memadai',
  },
  {
    id: 'RULE015',
    name: 'Pedoman Audit Tidak Ada',
    description: 'Klaim memiliki pedoman audit internal, tetapi dokumen tidak tersedia',
    conditionQuestionId: 'D.9',
    conditionAnswer: 'Ya',
    evidenceQuestionId: 'DPD3',
    evidenceCondition: 'empty',
    severity: 'minor',
    fraudType: 'Manipulasi Administratif',
  },
  {
    id: 'RULE016',
    name: 'Pengendalian Internal Tanpa Sistem',
    description: 'Klaim pengendalian internal efektif, tetapi tidak ada implementasi nyata',
    conditionQuestionId: 'D.1',
    conditionAnswer: 'Ya',
    evidenceQuestionId: 'D.6',
    evidenceCondition: 'Tidak',
    severity: 'major',
    fraudType: 'Inkonsistensi Kebijakan',
  },
];

export function generateRuleId(): string {
  return `RULE${Date.now().toString(36).toUpperCase()}`;
}

// Helper untuk menambah aturan baru dengan mudah
export function createFraudRule(
  name: string,
  description: string,
  conditionQuestionId: string,
  conditionAnswer: 'Ya' | 'Tidak',
  evidenceQuestionId: string,
  evidenceCondition: 'empty' | 'Tidak',
  severity: 'major' | 'minor',
  fraudType: string
): FraudRule {
  return {
    id: generateRuleId(),
    name,
    description,
    conditionQuestionId,
    conditionAnswer,
    evidenceQuestionId,
    evidenceCondition,
    severity,
    fraudType: fraudType as FraudRule['fraudType'],
  };
}
